/**
 * Kopa Framework Admin Media Uploader JS
 * Author: Kopatheme
 * Copyright: 2014 Kopatheme
 * License: GPLv2 or later
 * Used localized variable: kopa_upload_l10n
 */
jQuery(document).ready(function(a){function e(e,f){e.preventDefault();var g=a(this),h=f.find(".kopa_upload"),i=h.data("type"),j=d.indexOf(i),k={title:g.data("choose"),button:{text:g.data("update"),close:!1}};c=f,i&&(-1===j&&d.push(i),k.library={type:i}),kopaframework_modals&&(b=kopaframework_modals[j]),b?b.open():(b=wp.media.frames.kopaframework_upload=wp.media(k),b.on("select",function(){var d=b.state().get("selection").first();b.close(),c.find(".kopa_upload").val(d.attributes.url),"image"==d.attributes.type&&(c.find(".kopa_screenshot").empty().hide().removeClass("kopa_hide").append('<img src="'+d.attributes.url+'"><a class="kopa_remove_image">'+kopa_upload_l10n.remove+"</a>").slideDown("fast"),(a("body").hasClass("widgets-php")||a("body").hasClass("post-php"))&&(c.find("img").css("max-width","100%"),a("<br>").insertBefore(c.find(".kopa_remove_image").addClass("button"))));var e=c.find(".kopa_upload_button").addClass("kopa_remove_file").removeClass("kopa_upload_button");e.text()?e.text(kopa_upload_l10n.remove):e.val()&&e.val(kopa_upload_l10n.remove)}),kopaframework_modals.push(b)),b.open()}function f(b,c){b.preventDefault(),c.find(".kopa_remove_image").hide(),c.find(".kopa_upload").val(""),c.find(".kopa_screenshot").slideUp("fast");var d=c.find(".kopa_remove_file").addClass("kopa_upload_button").removeClass("kopa_remove_file");d.text()?d.text(kopa_upload_l10n.upload):d.val()&&d.val(kopa_upload_l10n.upload),a(".kopa_section_upload .kopa_upload_notice").length>0&&a(".kopa_upload_button").remove()}Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c;if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),e=d.length>>>0;if(0===e)return-1;var f=+b||0;if(1/0===Math.abs(f)&&(f=0),f>=e)return-1;for(c=Math.max(f>=0?f:e-Math.abs(f),0);e>c;){if(c in d&&d[c]===a)return c;c++}return-1});var b,c,d=[];kopaframework_modals=[],a("body").on("click",".kopa_remove_image, .kopa_remove_file",function(b){f(b,a(this).closest(".kopa_section"))}),a("body").on("click",".kopa_upload_button",function(b){e(b,a(this).closest(".kopa_section"))})});